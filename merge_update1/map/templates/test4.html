{% load static %}
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>simpleMap</title>
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<link rel="stylesheet" type="text/css" href="{% static '/css/map.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css" integrity="sha512-10/jx2EXwxxWqCLX/hHth/vu2KY3jCF70dCQB8TSgNjbCVAC/8vai53GfMDrO2Emgwccf2pJqxct9ehpzG+MTw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://apis.openapi.sk.com/tmap/jsv2?version=1&appKey=IOWlgu3VCB5vrfwE0YE0w3e24rgK4g612MZZEILt"></script>
<script type="text/javascript">
    var map;
    var InfoWindow,marker;
    var content,content1,content2,content3,rect;
    var url,lat,lon,name;
	var Clicklat,Clicklon;
	var result,resultDiv; 
    var centerlat,centerlon;
	var poiId,color;
	var poiId2,color2;
	var tData = new Tmapv2.extension.TData();
	let isSquareMapActive = false;
	let isAutoTrafficActive = false;
	let isMeasureDistanceActive = false; // í”Œë˜ê·¸ ë³€ìˆ˜ ì¶”ê°€
    let lastclicktime = 0;
    let lastclickx,lastclicky = 0;
    let currentDate = 0;
	 
     // ë§ˆì»¤ì™€ ë¼ë²¨ì„ ì €ì¥í•  ë°°ì—´ ì´ˆê¸°í™”
     var markerArr = [];
     var labelArr = [];

     var positions = [
    {
        title: 'í‹°ë§µëª¨ë¹Œë¦¬í‹°', 
        lonlat: new Tmapv2.LatLng(37.56520450, 126.98702028),
        keyword: 'í¬ë¦¬ìŠ¤ë§ˆìŠ¤'
    },
    {
        title: 'SKTíƒ€ì›Œ', 
        lonlat: new Tmapv2.LatLng(37.566369,126.984895),
        keyword: 'ì™€ì¸/ë°”'
    },
    {
        title: 'ê²½ì°°ì„œ', 
        lonlat: new Tmapv2.LatLng(37.563709,126.989577),
        keyword: 'ë¹„ê±´ì‹ë‹¹'
    },
    {
        title: 'í˜¸í…”',
        lonlat: new Tmapv2.LatLng(37.565138,126.983655),
        keyword: 'ì—°ë§íŒŒí‹°'
    },
    {
        title: 'ë³‘ì›',
        lonlat: new Tmapv2.LatLng(37.565128,126.988830),
        keyword: 'ë¸ŒëŸ°ì¹˜'
    }
];
     function initTmap(){
        // map ìƒì„±
        // Tmap.mapì„ ì´ìš©í•˜ì—¬, ì§€ë„ê°€ ë“¤ì–´ê°ˆ div, ë„“ì´, ë†’ì´ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
        map = new Tmapv2.Map("map_div", {
            center : new Tmapv2.LatLng(37.56520450, 126.98702028), // ì§€ë„ ì´ˆê¸° ì¢Œí‘œ
            zoom : 16,
            width : "70%", // mapì˜ width ì„¤ì •
            height : "700px" // mapì˜ height ì„¤ì •   
        });
    
        map.addListener("click", onClick);


        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function (position) {
                var lat = position.coords.latitude;
                var lon = position.coords.longitude;
                centerlat = lat;
                centerlon = lon;
                console.log(lat, lon);
    
                // ë§ˆì»¤ ìƒì„± ì‹œ, icon ì†ì„±ì— ìƒˆë¡œìš´ ì´ë¯¸ì§€ ê²½ë¡œ ì„¤ì •
                marker = new Tmapv2.Marker({
                    position: new Tmapv2.LatLng(lat, lon),
                    map: map,
                    icon: "/static/images/markerStar.png",  // ë§ˆì»¤ ì´ë¯¸ì§€ ë³€ê²½
                    iconSize: new Tmapv2.Size(24, 35) // ë§ˆì»¤ ì´ë¯¸ì§€ í¬ê¸° ì„¤ì • (í•„ìš”ì‹œ ì¡°ì •)
                });
    
                map.setCenter(new Tmapv2.LatLng(lat, lon));
                map.setZoom(16);

                updateMapCenter();
            });
        }

        // ì§€ë„ ì´ë™ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        map.addListener("dragend", function() {
        updateMapCenter();
        });
    
        // ê¸°ë³¸ ìƒíƒœë¡œ measureDistance ì‹¤í–‰
        measureDistance();
    }

    // ê¸°ë³¸ ì •ë³´
    function measureDistance() {
    resetActiveStates(); // ë‹¤ë¥¸ ê¸°ëŠ¥ ì´ˆê¸°í™”
    isMeasureDistanceActive = true; // measureDistance í™œì„±í™”

    $(".api_etc_btns > div#measureDistance").addClass("__color_blue_fill");
    $("#map_wrap").html('');
    }


    // ë‚ ì”¨ ì½”ë“œì™€ ì„¤ëª… ë§¤í•‘
const weatherDescriptions = {
    0: "ë§‘ìŒ",
    1: "ë¹„",
    2: "ë¹„/ëˆˆ",
    3: "ëˆˆ",
    4: "ì†Œë‚˜ê¸°",
    5: "ì´ìŠ¬ë¹„",
    6: "ë¹„ì™€ ëˆˆ ë‚ ë¦¼",
    7: "ëˆˆë‚ ë¦¼"
};

// í’í–¥ ì½”ë“œì™€ ì„¤ëª… ë§¤í•‘
function getWindDirection(degrees) {
    if (degrees >= 337.5 || degrees < 22.5) return "ë¶í’";
    if (degrees >= 22.5 && degrees < 67.5) return "ë¶ë™í’";
    if (degrees >= 67.5 && degrees < 112.5) return "ë™í’";
    if (degrees >= 112.5 && degrees < 157.5) return "ë‚¨ë™í’";
    if (degrees >= 157.5 && degrees < 202.5) return "ë‚¨í’";
    if (degrees >= 202.5 && degrees < 247.5) return "ë‚¨ì„œí’";
    if (degrees >= 247.5 && degrees < 292.5) return "ì„œí’";
    if (degrees >= 292.5 && degrees < 337.5) return "ë¶ì„œí’";
    return ""; // ê¸°ë³¸ê°’
}

function updateMapCenter() {
    var center = map.getCenter();
    centerlat = center.lat();
    centerlon = center.lng();
    console.log("New center: ", centerlat, centerlon);

    readCSV('/static/ê¸°ìƒì²­_ê²©ììœ„ê²½ë„.csv', function(data) {
        let { nearestLocation_s2, locX, locY } = processCSVData(data, centerlat, centerlon);
        let { formattedDate, formattedTime } = findnow();

        lastclickx = locX; 
        lastclicky = locY;
        lastClickTime = currentDate;

        if (nearestLocation_s2) {
            const xhr = new XMLHttpRequest();
            const apiUrl = 'http://apis.data.go.kr/1360000/VilageFcstInfoService_2.0/getUltraSrtNcst';
            const serviceKey = 'EPhM94JT5WuG2cnWrA7xBy4Ip1zeWGD%2Fc9StwgvLEua3LPV6Qgp9%2Bu%2Fq5hyyC9%2FtVA%2BL4WipZChsLpNs4obZ%2Bw%3D%3D';
            const queryParams = '?' + encodeURIComponent('serviceKey') + '=' + serviceKey +
                                '&' + encodeURIComponent('pageNo') + '=' + encodeURIComponent('1') +
                                '&' + encodeURIComponent('numOfRows') + '=' + encodeURIComponent('8') +
                                '&' + encodeURIComponent('dataType') + '=' + encodeURIComponent('Json') +
                                '&' + encodeURIComponent('base_date') + '=' + encodeURIComponent(formattedDate) +
                                '&' + encodeURIComponent('base_time') + '=' + encodeURIComponent(formattedTime) +
                                '&' + encodeURIComponent('nx') + '=' + encodeURIComponent(locX) +
                                '&' + encodeURIComponent('ny') + '=' + encodeURIComponent(locY);

            xhr.open('GET', apiUrl + queryParams);
            xhr.onreadystatechange = function() {
                if (this.readyState === 4) {
                    const { temperature, humidity, weather, wdDirection, wdStrength } = findSource(this.responseText);

                    const weatherDescription = weatherDescriptions[weather] || "ì•Œ ìˆ˜ ì—†ìŒ";
                    const windDirection = getWindDirection(parseFloat(wdDirection));
                    const weatherIcon = `/static/images/weather${weather}.png`;

                    const weatherHTML = `
                        <div class="weather-container">
                            <div class="location">${nearestLocation_s2}</div>
                            <div class="weather-info">
                                <div class="temperature">${temperature}Â°</div>
                                <img src="${weatherIcon}" alt="${weatherDescription}" class="weather-icon">
                            </div>
                            </div>
                            <div class="details">
                                <div>ìŠµë„ : ${humidity} %</div>
                                <div>í’í–¥ : ${windDirection}</div>
                                <div>í’ì† : ${wdStrength} m/s</div>
                            </div>
                        </div>`;
                    $(".how_we").html(weatherHTML);
                }
            };
            xhr.send('');
        }
    });
}

    
        // CSV íŒŒì¼ ì½ê¸°
        function readCSV(url, callback) {
            $.ajax({
                url: url,
                dataType: 'text',
                beforeSend: function(xhr) {
                    xhr.overrideMimeType('text/plain; charset=euc-kr');
                },
                success: function(data) {
                    callback(data);
                },
                error: function() {
                    alert('CSV íŒŒì¼ì„ ì½ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            });
        }
    
    
        // CSV íŒŒì¼ì—ì„œ ìœ„ê²½ë„ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜
        function processCSVData(data, centerlat, centerlon) {
        let lines = data.split("\n");
        let minDistance = Infinity;
        let nearestLocation_s2 = '';
        let locX = 0, locY = 0;
    
        // ê°€ì¥ ê°€ê¹Œìš´ ìœ„ì¹˜ ì°¾ê¸°
        lines.slice(1).forEach(line => {
            line = line.trim();
            if (line) {
                let [ , , ìë©´ë™, ìœ„ë„, ê²½ë„,x,y] = line.split(",");
                let distance = getDistance(centerlat, centerlon, parseFloat(ìœ„ë„), parseFloat(ê²½ë„));
                if (distance < minDistance) {
                    minDistance = distance;
                    nearestLocation_s2 = ìë©´ë™;
                    locX = x; // ê°€ì¥ ê°€ê¹Œìš´ ìœ„ì¹˜ì˜ ìœ„ë„ ì €ì¥
                    locY = y; // ê°€ì¥ ê°€ê¹Œìš´ ìœ„ì¹˜ì˜ ê²½ë„ ì €ì¥
                }
            }
        });
        
        console.log(`ê°€ì¥ ê°€ê¹Œìš´ ìœ„ì¹˜: ${nearestLocation_s2}, ìœ„ë„: ${locX}, ê²½ë„: ${locY}`);
        return { nearestLocation_s2, locX, locY };
        }   
    
        // ê±°ë¦¬ë¥¼ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜
        function getDistance(lat1, lon1, lat2, lon2) {
        const radius = 6371; // ì§€êµ¬ ë°˜ì§€ë¦„ (km)
        let toRad = (value) => (value * Math.PI) / 180;
        let dLat = toRad(lat2 - lat1);
        let dLon = toRad(lon2 - lon1);
        let a = Math.sin(dLat / 2) ** 2 +
                Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) * Math.sin(dLon / 2) ** 2;
        let c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
        return radius * c;
        }
       
        //í´ë¦­ ì‹œì ì˜ í˜„ì¬ ì‹œê°„ì„ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜
        function findnow() {
        let currentDate = new Date();
        
        // í¬ë§·ëœ ë‚ ì§œ (YYMMDD)
        let year = String(currentDate.getFullYear());
        let month = String(currentDate.getMonth() + 1).padStart(2, '0');
        let day = String(currentDate.getDate()).padStart(2, '0');
        let formattedDate = `${year}${month}${day}`;
    
        // í¬ë§·ëœ ì‹œê°„ (HHMM)
        let hours = String(currentDate.getHours()).padStart(2, '0');
        let minutes = (Math.floor(currentDate.getMinutes() / 10) * 10) - 10;
        if (minutes < 0) {
            minutes = 50; // ë§Œì•½ minutesì´ 0ë³´ë‹¤ ì‘ì•„ì§€ë©´, 50ìœ¼ë¡œ ì„¤ì • (í•œ ì‹œê°„ ì „ 50ë¶„)
            hours = String(currentDate.getHours() - 1).padStart(2, '0'); // í•œ ì‹œê°„ ì „
        }
        let formattedTime = `${hours}${String(minutes).padStart(2, '0')}`;
        
        console.log(formattedDate); // ì˜ˆ: 20241210
        console.log(formattedTime); // ì˜ˆ: 1930
        return { formattedDate, formattedTime };
    }
    
    
    
    
        // ê¸°ìƒì²­ API > JSON ë°ì´í„°ì—ì„œ í•„ìš”í•œ ì •ë³´ ì¶”ì¶œ
        function findSource(responseText) {
            let data = JSON.parse(responseText);
            let items = data.response.body.items.item;
            if(!items){alert("ê¸°ìƒì²­ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."); return false;}
    
            // ë³€ìˆ˜ ì„ ì–¸ ë° ì´ˆê¸°í™”
            let temperature = '';
            let humidity = '';
            let weather = '';
            let wdDirection = '';
            let wdStrength = '';
    
            items.forEach(item => {
                if (item.category === "PTY") {
                    weather = item.obsrValue;
                } else if (item.category === "REH") {
                    humidity = item.obsrValue;
                } else if (item.category === "T1H") {
                    temperature = item.obsrValue;
                } else if (item.category === "VEC") {
                    wdDirection = item.obsrValue;
                } else if (item.category === "WSD") {
                    wdStrength = item.obsrValue;
                }
            });
    
            return { temperature, humidity, weather, wdDirection, wdStrength };
        }

    // puzzleí•¨ìˆ˜
    function onClick(e) {
        var Clicklon = e.latLng.lng();
        var Clicklat = e.latLng.lat();
       if (isSquareMapActive) {
       reverseLabel(Clicklon, Clicklat);} }
	
	function reverseLabel(Clicklon, Clicklat) {
			zoomLevel = map.getZoom();
			if (zoomLevel < 15) zoomLevel = 15;
	
			var headers = {};
			headers["appKey"] = "IOWlgu3VCB5vrfwE0YE0w3e24rgK4g612MZZEILt";
	
			$.ajax({
					method: "GET",
					headers: headers,
					url: "https://apis.openapi.sk.com/tmap/geo/reverseLabel?version=1&format=json&callback=result",
					async: false,
					data: {
							reqLevel: zoomLevel,
							centerLon: Clicklon,
							centerLat: Clicklat,
							reqCoordType: "WGS84GEO",
							resCoordType: "WGS84GEO",
					},
					success: function (response) {
							var resultInfo = response.poiInfo;
							lat = resultInfo.poiLat;
							lon = resultInfo.poiLon;
							poiId = resultInfo.id;
							name = resultInfo.name;
	
							url = `https://apis.openapi.sk.com/tmap/puzzle/pois/${poiId}?format=json&appKey=IOWlgu3VCB5vrfwE0YE0w3e24rgK4g612MZZEILt&lat=${Clicklat}&lng=${Clicklon}`;
	
							reset();
							puzzle(url, lon, lat, Clicklon, Clicklat);
					},
					error: function (request, status, error) {
							console.log("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);
					},
			});
	}
	
    function reset(){
        if(InfoWindow != undefined){
            InfoWindow.setMap(null);
            InfoWindow = undefined;
        }
        if(marker != undefined){
            marker.setMap(null);
        }
        if(rect != undefined){
                rect.setMap(null);
                rect = undefined;
            }
	   }


	function puzzle(url, lon, lat, Clicklon, Clicklat) {
    // ì´ì „ ì˜¤ë²„ë ˆì´ ì‚­ì œ
    if (InfoWindow) {
        InfoWindow.setMap(null);
        InfoWindow = undefined;
    }

    $.ajax({
        method: "GET",
        url: url,
        async: false,
        data: {},
        success: function (response) {
            var rltm = response.contents.rltm;
            var congestion, congestionLevel, datetime;
            var congestion2, congestionLevel2, datetime2;

            for (var i = 0; i < rltm.length; i++) {
                if (rltm[i].type == 1) {
                    congestion = (Number(rltm[i].congestion) * 100).toFixed(2);
                    congestionLevel = rltm[i].congestionLevel;
                    datetime = rltm[i].datetime;
                } else if (rltm[i].type == 2) {
                    congestion2 = (Number(rltm[i].congestion) * 100).toFixed(2);
                    congestionLevel2 = rltm[i].congestionLevel;
                    datetime2 = rltm[i].datetime;
                }
            }

            const colorObj = congestionLevelColor(congestionLevel);
            const colorObj2 = congestionLevelColor(congestionLevel2);
            color = colorObj.color;
            congest = colorObj.congest;
            color2 = colorObj2.color;
            congest2 = colorObj2.congest;

            rect = new Tmapv2.Rectangle({
                bounds: new Tmapv2.LatLngBounds(
                    new Tmapv2.LatLng(Number(Clicklat) + 0.0014957, Number(Clicklon) - 0.0018867),
                    new Tmapv2.LatLng(Number(Clicklat) - 0.0014957, Number(Clicklon) + 0.0018867)
                ), // ì‚¬ê°í˜• ì˜ì—­ ì¢Œí‘œ
                strokeColor: "#000000", // í…Œë‘ë¦¬ ìƒ‰ìƒ
                strokeWeight: 2.5,
                strokeOpacity: 1,
                fillColor: color2, // ì‚¬ê°í˜• ë‚´ë¶€ ìƒ‰ìƒ
                fillOpacity: 0.5,
                map: map, // ì§€ë„ ê°ì²´
            });

            if (rltm.length >= 2) {
                var year = datetime.substr(0, 4);
                var month = datetime.substr(4, 2);
                var day = datetime.substr(6, 2);
                var hour = datetime.substr(8, 2);
                var min = datetime.substr(10, 2);
                var sec = datetime.substr(12, 2);
                var date = `${year}ë…„ ${month}ì›” ${day}ì¼ ${hour}ì‹œ ${min}ë¶„ ${sec}ì´ˆ`;

                var year2 = datetime2.substr(0, 4);
                var month2 = datetime2.substr(4, 2);
                var day2 = datetime2.substr(6, 2);
                var hour2 = datetime2.substr(8, 2);
                var min2 = datetime2.substr(10, 2);
                var sec2 = datetime2.substr(12, 2);
                var date2 = `${year2}ë…„ ${month2}ì›” ${day2}ì¼ ${hour2}ì‹œ ${min2}ë¶„ ${sec2}ì´ˆ`;

                result = `[ì¥ì†Œ] ${name} [${congest}, ${congestion}ëª…/100mÂ²]<br>`;
                result += `[ì£¼ë³€] ${name} [${congest2}, ${congestion2}ëª…/100mÂ²]`;

                // ìƒˆë¡œìš´ InfoWindow ìƒì„±
                InfoWindow = new Tmapv2.InfoWindow({
                    position: new Tmapv2.LatLng(Clicklat, Clicklon), // ì‚¬ê°í˜• ì¤‘ì‹¬ ì¢Œí‘œ
                    content: `<div style="background: rgba(255, 255, 255, 0.7); 
                                         border: 1px solid #000; 
                                         padding: 5px; 
                                         border-radius: 5px; 
                                         text-align: center;">
                                 ${result}
                             </div>`, // í…ìŠ¤íŠ¸ ë‚´ìš©
                    type: 2, // type 2ë¡œ ì„¤ì •í•˜ë©´ ì§€ë„ ìœ„ ê³ ì •
                    map: map, // ì§€ë„ ê°ì²´
                });
            } else {
                result = `[ì£¼ë³€] ${name} [${congest2}, ${congestion2}ëª…/100mÂ²]`;

                // ìƒˆë¡œìš´ InfoWindow ìƒì„±
                InfoWindow = new Tmapv2.InfoWindow({
                    position: new Tmapv2.LatLng(Clicklat, Clicklon), // ì‚¬ê°í˜• ì¤‘ì‹¬ ì¢Œí‘œ
                    content: `<div style="background: rgba(255, 255, 255, 0.7); 
                                         border: 1px solid #000; 
                                         padding: 5px; 
                                         border-radius: 5px; 
                                         text-align: center;">
                                 ${result}
                             </div>`, // í…ìŠ¤íŠ¸ ë‚´ìš©
                    type: 2, // type 2ë¡œ ì„¤ì •í•˜ë©´ ì§€ë„ ìœ„ ê³ ì •
                    map: map, // ì§€ë„ ê°ì²´
                });
            }

        },
        error: function (request, status, error) {
            if (request.status == "404") {
                result = `POI ID: ${poiId}, ${name}, í•´ë‹¹ ì¢Œí‘œëŠ” ì‹¤ì‹œê°„ ì¥ì†Œ í˜¼ì¡ë„ë¥¼ ì§€ì›í•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.`;
                $("").text(result);
            } else {
                console.log("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);
            }
            },
        });
    }
	
    // í˜¼ì¡ë„
	function squareMap() {
    resetActiveStates(); // ë‹¤ë¥¸ ê¸°ëŠ¥ ì´ˆê¸°í™”
    isSquareMapActive = true; // squareMap í™œì„±í™”

    $(".api_etc_btns > div#squareMap").addClass("__color_blue_fill");
    $("#map_wrap").html(`
        <div id="map_div" class="map_wrap" style='position: relative; bottom: -20px;'></div>
        <div style='position: relative; bottom: 135px; left: 10px; width: 95px; height: 140px; text-align: center; background: #ffffff; border: 1px solid #808080; border-radius: 3px; font-size: 12px'>
            ì¥ì†Œí˜¼ì¡ë„ ë‹¨ê³„
            <div style='width: 84px; height: 25px; border: 1px solid #808080; text-align: center; background: #9cf7bd; border-radius: 3px; margin: 3px auto'>ì—¬ìœ </div>
            <div style='width: 84px; height: 25px; border: 1px solid #808080; text-align: center; background: #73b7ff; border-radius: 3px; margin: 3px auto'>ë³´í†µ</div>
            <div style='width: 84px; height: 25px; border: 1px solid #808080; text-align: center; background: #d9a8ed; border-radius: 3px; margin: 3px auto'>í˜¼ì¡</div>
            <div style='width: 84px; height: 25px; border: 1px solid #808080; text-align: center; background: #ff96b4; border-radius: 3px; margin: 3px auto'>ë§¤ìš° í˜¼ì¡</div>
        </div>
    `);
    }
    
    //í˜¼ì¡ë„ë³„ ìƒ‰ìƒ, í˜¼ì¡ë„ í‘œì‹œ í•¨ìˆ˜
	   function congestionLevelColor(congestionLevel){
		   var congest = ""
		   var color = ""
		   
		   switch(congestionLevel){
			case 1:
				congest ="ì—¬ìœ ";
				color = '#9cf7bd';
				break;
			case 2:
				congest ="ë³´í†µ";
	  			color ='#73b7ff';
				break;
			case 3:
				congest ="í˜¼ì¡";
		  		color ='#d9a8ed';
				break;
			case 4:
				congest ="ë§¤ìš° í˜¼ì¡";
		  		color ='#ff96b4';
				break;
			}
		   return {"color":color,"congest":congest}
	   }

    function resetActiveStates() {
    // ëª¨ë“  ê¸°ëŠ¥ì˜ í™œì„± ìƒíƒœë¥¼ ì´ˆê¸°í™”
    isSquareMapActive = false;
    isAutoTrafficActive = false;
    isMeasureDistanceActive = false;

    // ë²„íŠ¼ UI ì´ˆê¸°í™”
    $(".api_etc_btns > div").removeClass("__color_blue_fill");
	$(".api_etc_labels > div").hide();

    // ì§€ë„ ìœ„ ê°ì²´ ì´ˆê¸°í™”
    if (rect) {
        rect.setMap(null);
        rect = undefined;
    }
    if (InfoWindow) {
        InfoWindow.setMap(null);
        InfoWindow = undefined;
    }

		try {
      tData.autoTraffic(map, { trafficOnOff: false });
    } catch (error) {}
    // ì§€ë„ ì´ˆê¸°í™”
    $("#map_wrap").empty();
    }

    function resetMeasureObject() {
    $(".api_etc_btns > div").removeClass("__color_blue_fill");
    $(".api_etc_labels > div").hide();

    // ê¸°ë³¸ ì •ë³´ ì œê±°
    try {
      if (measureDistance) {
        measureDistance.remove();
      }
    } catch (error) {}

    // êµí†µì •ë³´ ì œê±°
    try {
      tData.autoTraffic(map, { trafficOnOff: false });
    } catch (error) {}

    // ì¶”ê°€ì ì¸ UI ì´ˆê¸°í™”
    $("#map_wrap").empty();
    }
    // puzzleí•¨ìˆ˜ ë

    // êµí†µì •ë³´ ì‹œì‘
    function autoTraffic() {
        resetActiveStates(); // ë‹¤ë¥¸ ê¸°ëŠ¥ ì´ˆê¸°í™”
        isAutoTrafficActive = true; // autoTraffic í™œì„±í™”

        $(".api_etc_btns > div#autoTraffic").addClass("__color_blue_fill");
        tData.autoTraffic(map, { trafficOnOff: true });

        $("#map_wrap").html(`
                <div id="map_div" class="map_wrap" style="position: relative; bottom: -20px;"></div>
                <div style="position: relative; bottom: 135px; left: 10px; width: 95px; height: 140px; text-align: center; background: #ffffff; border: 1px solid #808080; border-radius: 3px; font-size: 12px">
                        êµí†µìƒí™© ë‹¨ê³„
                        <div style="width: 84px; height: 25px; border: 1px solid #808080; text-align: center; background: #99cc00; border-radius: 3px; margin: 3px auto">ì—¬ìœ </div>
                        <div style="width: 84px; height: 25px; border: 1px solid #808080; text-align: center; background: yellow; border-radius: 3px; margin: 3px auto">ë³´í†µ</div>
                        <div style="width: 84px; height: 25px; border: 1px solid #808080; text-align: center; background: orange; border-radius: 3px; margin: 3px auto">í˜¼ì¡</div>
                        <div style="width: 84px; height: 25px; border: 1px solid #808080; text-align: center; background: #cc0000; border-radius: 3px; margin: 3px auto">ë§¤ìš° í˜¼ì¡</div>
                </div>
        `);
	}
	   
	//í˜¼ì¡ë„ë³„ ìƒ‰ìƒ, í˜¼ì¡ë„ í‘œì‹œ í•¨ìˆ˜
    function congestionLevelColor(congestionLevel){
        var congest = ""
        var color = ""
        
        switch(congestionLevel){
        case 1:
            congest ="ì—¬ìœ ";
            color = '#9cf7bd';
            break;
        case 2:
            congest ="ë³´í†µ";
            color ='#73b7ff';
            break;
        case 3:
            congest ="í˜¼ì¡";
            color ='#d9a8ed';
            break;
        case 4:
            congest ="ë§¤ìš° í˜¼ì¡";
            color ='#ff96b4';
            break;
        }
        return {"color":color,"congest":congest}
    }


    $(document).ready(function() {
        // ì§€ë„ ê²€ìƒ‰ì°½ ê¸°ëŠ¥
        $("#btn_select").on("click", function () {
            var searchKeyword = $('#searchKeyword').val(); // ê²€ìƒ‰ í‚¤ì›Œë“œ
            var headers = {};
            headers["appKey"] = "IOWlgu3VCB5vrfwE0YE0w3e24rgK4g612MZZEILt";

            // í˜„ì¬ ì§€ë„ ì¤‘ì‹¬ ì¢Œí‘œ ê°€ì ¸ì˜¤ê¸°
            var currentCenter, currentLat, currentLon;
            console.log("í˜„ì¬ ì§€ë„ ì¤‘ì‹¬ ì¢Œí‘œ:", currentLat, currentLon);
            if (map && typeof map.getCenter === 'function') {
            currentCenter = map.getCenter();
            currentLat = currentCenter.lat();
            currentLon = currentCenter.lng();
            } else {
            console.log("map.getCenter() is not available");
            }

            // li ì´ë¯¸ì§€ ìƒíƒœ ì—…ë°ì´íŠ¸
            updateCategoryImage(searchKeyword);
    
            // ì¹´í…Œê³ ë¦¬ì™€ ê´€ë ¨ ì—†ëŠ” í‚¤ì›Œë“œ ê²€ìƒ‰ ì‹œ 10ê°œë§Œ ì¶œë ¥, ì¹´í…Œê³ ë¦¬ ê´€ë ¨ ì‹œ 50ê°œ ì¶œë ¥
            var resultCount = (isCategoryRelated(searchKeyword)) ? 200 : 50;
    
            // ë§ˆì»¤ ì´ë¯¸ì§€ ê²°ì •
            var markerImage = getMarkerImage(searchKeyword);
    
            // ê²€ìƒ‰ì–´ê°€ ë¹„ì–´ìˆì„ ê²½ìš° ë§ˆì»¤ì™€ ê²°ê³¼ ì´ˆê¸°í™”
            if (!searchKeyword) {
                clearMarkers();  // ë§ˆì»¤ ë° ê²°ê³¼ ì´ˆê¸°í™”
                $("#searchResult").html("");  // ê²€ìƒ‰ ê²°ê³¼ ëª©ë¡ ì´ˆê¸°í™”
                return;
            }
    
            $.ajax({
                method: "GET", // ìš”ì²­ ë°©ì‹
                headers: headers,
                url: "https://apis.openapi.sk.com/tmap/pois?version=1&format=json", // url ì£¼ì†Œ
                data: { // ìš”ì²­ ë°ì´í„° ì •ë³´
                    "searchKeyword": searchKeyword, // ê²€ìƒ‰ í‚¤ì›Œë“œ
                    "resCoordType": "EPSG3857", // ì‘ë‹µ ì¢Œí‘œê³„
                    "centerLon": currentLon,
                    "centerLat": currentLat,
                    "count": resultCount // ì¶œë ¥ë˜ëŠ” ë°ì´í„° ê°œìˆ˜
                },
                success: function (response) {
                    var resultpoisData = response.searchPoiInfo.pois.poi;
    
                    // ê¸°ì¡´ ë§ˆì»¤, íŒì—… ì œê±°
                    clearMarkers();
    
                    var innerHtml = ""; // searchResult ê²°ê³¼ê°’ ë…¸ì¶œ ìœ„í•œ ë³€ìˆ˜
                    var positionBounds = new Tmapv2.LatLngBounds(); // LatLngBounds ê°ì²´ ìƒì„±
    
                    // POI ë§ˆì»¤ í‘œì‹œ
                    for (var k in resultpoisData) {
                        var noorLat = Number(resultpoisData[k].noorLat);
                        var noorLon = Number(resultpoisData[k].noorLon);
                        var name = resultpoisData[k].name;
                        var id = resultpoisData[k].id;
    
                        // ì¢Œí‘œ ê°ì²´ ìƒì„±
                        var pointCng = new Tmapv2.Point(noorLon, noorLat);
    
                        // EPSG3857 ì¢Œí‘œê³„ë¥¼ WGS84GEO ì¢Œí‘œê³„ë¡œ ë³€í™˜
                        var projectionCng = new Tmapv2.Projection.convertEPSG3857ToWGS84GEO(pointCng);
    
                        var lat = projectionCng._lat;
                        var lon = projectionCng._lng;
    
                        var markerPosition = new Tmapv2.LatLng(lat, lon);
    
                        // ë§ˆì»¤ ì„¤ì •
                        var marker = new Tmapv2.Marker({
                            position: markerPosition, // ë§ˆì»¤ ìœ„ì¹˜
                            icon: markerImage, // ì¹´í…Œê³ ë¦¬ì— ë§ëŠ” ë§ˆì»¤ ì´ë¯¸ì§€ ì‚¬ìš©
                            iconSize: new Tmapv2.Size(30, 35), // ë§ˆì»¤ í¬ê¸° (24x35)
                            title: name, // ë§ˆì»¤ ì œëª©
                            map: map // ì§€ë„ì— ë§ˆì»¤ ë“±ë¡
                        });
    
                        // ê²°ê³¼ì°½ì— ë‚˜íƒ€ë‚  HTML êµ¬ì„±
                        innerHtml += "<li><div><img src='" + markerImage + "' style='vertical-align:middle;' class='marker-img'>&nbsp;&nbsp;<span>"
                            + name
                            + "&nbsp;&nbsp;</span><button type='button' name='sendBtn' onClick='poiDetail(" + id + ");'> ìƒì„¸ë³´ê¸°</button></div></li><br>";
    
                        // ë§ˆì»¤ ë°°ì—´ì— ì €ì¥
                        markerArr.push(marker);
                        positionBounds.extend(markerPosition); // LatLngBounds í™•ì¥
                    }
    
                    // ê²€ìƒ‰ ê²°ê³¼ ì¶œë ¥
                    $("#searchResult").html(innerHtml);
    
                    // ë°”ìš´ë“œ ì„¤ì • ì—†ì´, ë§µ ìœ„ì¹˜ ê³ ì •
                    if (markerArr.length > 0) {
                        // í˜„ì¬ ë§µì˜ ì¤Œ ë ˆë²¨ì„ ì €ì¥
                        var currentZoom = map.getZoom();
    
                        // ë§ˆì»¤ë“¤ì´ ìƒì„±ë˜ì—ˆì„ ë•Œë§Œ ì¤‘ì‹¬ì„ ì„¤ì •í•˜ê³  í™•ëŒ€í•˜ì§€ ì•ŠìŒ
                        var centerPosition = markerArr[0].getPosition(); // ì²« ë²ˆì§¸ ë§ˆì»¤ ìœ„ì¹˜ë¡œ ë§µ ì¤‘ì‹¬ ì„¤ì •
                        map.setCenter(currentCenter);
    
                        // ê¸°ì¡´ ì¤Œ ë ˆë²¨ì„ ìœ ì§€
                        map.setZoom(currentZoom);
                    }
                },
                error: function (request, status, error) {
                    console.log("code:" + request.status + "\n"
                        + "message:" + request.responseText
                        + "\n" + "error:" + error);
                }
            });
        });

        $(".hashtag").on("click", function (e) {
            e.preventDefault(); // ê¸°ë³¸ ë™ì‘ ë°©ì§€
        
            var text = $(this).text().trim(); // í…ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
            var keyword = text.split('#')[1].trim().slice(0, -2); // # ì œê±° í›„ ë’¤ì˜ ë‹¨ì–´ ì¶”ì¶œ
        
            // ì´ë¯¸ í™œì„±í™”ëœ lië¥¼ ë‹¤ì‹œ í´ë¦­í•œ ê²½ìš°
            if ($(this).hasClass("active")) {
                // ìƒíƒœ ì´ˆê¸°í™”
                $('#searchKeyword').val(""); // ê²€ìƒ‰ì°½ ë¹„ìš°ê¸°
                $("#searchResult").html(""); // ê²€ìƒ‰ ê²°ê³¼ ì´ˆê¸°í™”
                clearMarkers(); // ë§ˆì»¤ ì´ˆê¸°í™”
                updateCategoryImage(""); // ëª¨ë“  li ì´ë¯¸ì§€ ìƒíƒœ ì´ˆê¸°í™”
        
                // liì˜ active ìƒíƒœ ì œê±° ë° ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
                $(".hashtag").removeClass("active").css({
                    "background-color": "#ffc792",
                    "color": "black"
                });
        
            }
        
            // ë‹¤ë¥¸ liê°€ ì„ íƒëœ ê²½ìš°
            $(".hashtag").removeClass("active").css({
                "background-color": "#ffc792",
                "color": "black"
            });
        
            $(this).addClass("active").css({
                "background-color": "#FF9E44",
                "color": "white"
            });
        
            $("#searchKeyword").val(keyword); // ê²€ìƒ‰ì°½ì— í‚¤ì›Œë“œ ì…ë ¥
            console.log(keyword);
            $("#btn_select").click(); // ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­ íŠ¸ë¦¬ê±°
        });
        
    });
    
    
    // ì¹´í…Œê³ ë¦¬ í•¨ìˆ˜ ì‹œì‘
    // ì¹´í…Œê³ ë¦¬ì™€ ê´€ë ¨ëœ ê²€ìƒ‰ì¸ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
    function isCategoryRelated(keyword) {
        var relatedKeywords = ["ì¹´í˜", "ATM", "ì£¼ì°¨ì¥", "í™”ì¥ì‹¤", "ì•½êµ­", "ì£¼ìœ ì†Œ"];  // tmap ì¹´í…Œê³ ë¦¬ ê´€ë ¨ í‚¤ì›Œë“œ ëª©ë¡
        return relatedKeywords.includes(keyword);
    }
    
    // ì¹´í…Œê³ ë¦¬ì— ë§ëŠ” ë§ˆì»¤ ì´ë¯¸ì§€ ë°˜í™˜ í•¨ìˆ˜
    function getMarkerImage(keyword) {
        // ì¹´í…Œê³ ë¦¬ ê´€ë ¨ í‚¤ì›Œë“œì— ë§ëŠ” ë§ˆì»¤ ì´ë¯¸ì§€ ë°˜í™˜
        if (isCategoryRelated(keyword)) {
            switch (keyword) {
                case "ì¹´í˜":
                    return "/static/images/cafepin.png"; // ì¹´í˜ ë§ˆì»¤ ì´ë¯¸ì§€
                case "ATM":
                    return "/static/images/atmpin.png"; // ATM ë§ˆì»¤ ì´ë¯¸ì§€
                case "ì£¼ì°¨ì¥":
                    return "/static/images/parkpin.png"; // ì£¼ì°¨ì¥ ë§ˆì»¤ ì´ë¯¸ì§€
                case "í™”ì¥ì‹¤":
                    return "/static/images/bath.png"; // í™”ì¥ì‹¤ ë§ˆì»¤ ì´ë¯¸ì§€
                case "ì•½êµ­":
                    return "/static/images/mad.png"; // ì•½êµ­ ë§ˆì»¤ ì´ë¯¸ì§€
                case "ì£¼ìœ ì†Œ":
                    return "/static/images/oilpin.png"; // ì£¼ìœ ì†Œ ë§ˆì»¤ ì´ë¯¸ì§€
                default:
                    return "/static/images/defaultpin.png"; // ê¸°ë³¸ ë§ˆì»¤ ì´ë¯¸ì§€
            }
        } else {
            // ì¹´í…Œê³ ë¦¬ ê´€ë ¨ ì—†ëŠ” ê²½ìš° ê¸°ë³¸ ë§ˆì»¤ ì´ë¯¸ì§€
            return "/static/images/default.png"; 
        }
    }
    
    // ì¹´í…Œê³ ë¦¬ ê´€ë ¨ëœ li ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateCategoryImage(searchKeyword) {
        const listItems = document.querySelectorAll("#s_c li");
    
        listItems.forEach(item => {
            const text = item.textContent.trim(); // liì˜ í…ìŠ¤íŠ¸ (ì¹´í…Œê³ ë¦¬ëª…)
            const imageOff = item.getAttribute("data-image-off");
            const imageOn = item.getAttribute("data-image-on");
    
            if (text === searchKeyword) {
                // ê²€ìƒ‰ì–´ì™€ ì¼ì¹˜í•˜ëŠ” lië¥¼ í™œì„±í™” ìƒíƒœë¡œ ì„¤ì •
                item.style.backgroundImage = `url(${imageOn})`;
                item.classList.add("active");
            } else {
                // ê²€ìƒ‰ì–´ì™€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” liëŠ” ë¹„í™œì„±í™” ìƒíƒœë¡œ ì„¤ì •
                item.style.backgroundImage = `url(${imageOff})`;
                item.classList.remove("active");
            }
        });
    }
    
    // ë§ˆì»¤ ë° ê²°ê³¼ ì´ˆê¸°í™” í•¨ìˆ˜
    function clearMarkers() {
        // ê¸°ì¡´ ë§ˆì»¤, íŒì—… ì œê±°
        if (markerArr.length > 0) {
            for (var i in markerArr) {
                markerArr[i].setMap(null);
            }
            markerArr = [];
        }
    
        if (labelArr.length > 0) {
            for (var i in labelArr) {
                labelArr[i].setMap(null);
            }
            labelArr = [];
        }
    }
    
    // ì¹´í…Œê³ ë¦¬ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    document.addEventListener("DOMContentLoaded", () => {
        const listItems = document.querySelectorAll("#s_c li");
    
        listItems.forEach(item => {
            const imageOff = item.getAttribute("data-image-off");
            item.style.backgroundImage = `url(${imageOff})`;
    
            item.addEventListener("click", () => {
                const searchKeyword = item.textContent.trim();
    
                // í˜„ì¬ í´ë¦­ëœ ì¹´í…Œê³ ë¦¬ê°€ ì´ë¯¸ í™œì„±í™” ìƒíƒœì¼ ê²½ìš°
                if (item.classList.contains("active")) {
                    // ê²€ìƒ‰ì°½ì„ ì´ˆê¸°í™”í•˜ê³ , ë§ˆì»¤ì™€ ê²°ê³¼ë„ ì´ˆê¸°í™”
                    $('#searchKeyword').val("");
                    $("#searchResult").html("");
                    clearMarkers();
                    updateCategoryImage(""); // ëª¨ë“  li ì´ë¯¸ì§€ ìƒíƒœ ì´ˆê¸°í™”
                } else {
                    // ëª¨ë“  lië¥¼ ì´ˆê¸°í™”
                    listItems.forEach(otherItem => {
                        const otherImageOff = otherItem.getAttribute("data-image-off");
                        otherItem.style.backgroundImage = `url(${otherImageOff})`;
                        otherItem.classList.remove("active"); // í™œì„±í™” ìƒíƒœ ì œê±°
                    });
    
                    // í´ë¦­í•œ lië¥¼ í™œì„±í™” ìƒíƒœë¡œ ì „í™˜
                    const imageOn = item.getAttribute("data-image-on");
                    item.style.backgroundImage = `url(${imageOn})`;
                    item.classList.add("active");
    
                    // ê²€ìƒ‰ì°½ì— ì…ë ¥ëœ ê°’ë„ ë™ê¸°í™”
                    $('#searchKeyword').val(searchKeyword);
    
                    // ê²€ìƒ‰ ê²°ê³¼ë„ ë°”ë¡œ ì¶œë ¥
                    $("#btn_select").click();
                }
            });
        });
    });
    // ì¹´í…Œê³ ë¦¬ í•¨ìˆ˜ ë


var remote = "{{ remote }}";
var search_word = "{{ search_word|escapejs }}";
if (remote == "1") {
    setTimeout(function() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                var lat = position.coords.latitude;
                var lon = position.coords.longitude;
                setMapCenter(lat, lon, search_word);
            })
        } else {
            console.error("Geolocation is not supported by this browser.");
            // ê¸°ë³¸ ìœ„ì¹˜ ê°’ ì‚¬ìš©
            var lat = currentLat;
            var lon = currentLon;
            setMapCenter(lat, lon, search_word);
        }

        updateMapCenter();
        $('#searchKeyword').val(search_word);
        $("#btn_select").trigger('click');

        console.log("Remote:", remote);
        console.log("search_word:", search_word);
    }, 70);  // ë”œë ˆì´

}

// 4. POI ìƒì„¸ ì •ë³´ API
    //--- POI ìƒì„¸ ì •ë³´ API Sample >> https://tmapapi.tmapmobility.com/main.html#webservice/sample/WebSamplePoiDetail
    function poiDetail(poiId) {
        var headers = {}; 
        headers["appKey"] = "IOWlgu3VCB5vrfwE0YE0w3e24rgK4g612MZZEILt";
    
        $.ajax({
            method: "GET",
            headers: headers,
            url: "https://apis.openapi.sk.com/tmap/pois/" + poiId + "?version=1&resCoordType=EPSG3857&format=json",
            success: function(response) {
                var detailInfo = response.poiDetailInfo;
                var name = detailInfo.name;
                var telNo = detailInfo.telNo;
                var roadName = detailInfo.roadName;
                var address = detailInfo.address;
                var firstNo = detailInfo.firstNo;
                var secondNo = detailInfo.secondNo;
                var subClassNmC = detailInfo.subClassNmC;
                var desc = detailInfo.desc;
                var id = detailInfo.id;
                var pkey = detailInfo.pkey;
    
                var content = `
                    <div style='position: relative; padding: 20px;'>
                        <div style='position: absolute; top: 10px; right: 10px; cursor: pointer; font-size: 20px;' onclick='closeSlidePanel();'>Ã—</div>
                        <div>
                            <b style='color: black; font-size: 30px; line-height: 1.5;'>${name}</b><br>
                            <b style='color: black; font-size: 30px; line-height: 1.5;'>${id}</b><br>
                            <b style='color: black; font-size: 30px; line-height: 1.5;'>${pkey}</b><br>
                            <b style='font-size: 20px; line-height: 1.5;'>subClassNmC :</b> ${subClassNmC}<br>
                            <b style='font-size: 20px; line-height: 1.5;'><i class="fa-solid fa-location-dot"></i> ${address} ${roadName} ${firstNo}-${secondNo}</b><br>
                            <b style='font-size: 20px; line-height: 1.5;'><i class="fa-solid fa-phone"></i> ${telNo}</b><br>
                            <b style='font-size: 20px; line-height: 1.5; font-weight: 400;'><i class="fa-solid fa-circle-info"></i> ${desc}</b>
                        </div>
                    </div>
                    `;
    
                // ë‚´ìš© ì‚½ì…
                document.getElementById("slide_content").innerHTML = content;
    
                // ìŠ¬ë¼ì´ë“œ íŒ¨ë„ í‘œì‹œ
                var slidePanel = document.getElementById("slide_panel");
                slidePanel.classList.add("active");
            },
            error: function(request, status, error) {
                console.log("code:" + request.status + "\n" + "message:" + request.responseText + "\n" + "error:" + error);
            }
        });
    }
    
    function closeSlidePanel() {
        var slidePanel = document.getElementById("slide_panel");
        slidePanel.classList.remove("active");
    }

    // ì •ë³´ ë„£ê¸°
    
</script>
<body onload="initTmap();">
    <div id="content-wrapper">
        <p id="result"></p>
        <div id="map_div" style="position: relative;">
            <div class="_map_layer_overlay" style="padding-top: 10px;">
            <div class="__space_10_h"></div>
            <div class="api_etc_btns _map_overlay_row __flex_align_start" >
                <div style="margin-left:35px;"></div>
                <div id="measureDistance" class="_btn_radio" onclick="measureDistance();">ê¸°ë³¸</div>
                <div class="__space_10_w"></div>
                <div id="squareMap" class="_btn_radio" onclick="squareMap();">í˜¼ì¡ë„</div>
                <div class="__space_10_w"></div>
                <div id="autoTraffic" class="_btn_radio" onclick="autoTraffic();">êµí†µì •ë³´</div>
                <div class="__space_10_w"></div>
            </div>
            <ul id="s_c">
                <li data-image-on="/static/images/cafepin.png" data-image-off="/static/images/cafepin_no.png">ì¹´í˜</li>
                <li data-image-on="/static/images/atmpin.png" data-image-off="/static/images/atmpin_no.png">ATM</li>
                <li data-image-on="/static/images/parkpin.png" data-image-off="/static/images/park_no.png">ì£¼ì°¨ì¥</li>
                <li data-image-on="/static/images/bath.png" data-image-off="/static/images/bath_no.png">í™”ì¥ì‹¤</li>
                <li data-image-on="/static/images/mad.png" data-image-off="/static/images/mad_no.png">ì•½êµ­</li>
                <li data-image-on="/static/images/oilpin.png" data-image-off="/static/images/oil_no.png">ì£¼ìœ ì†Œ</li>
            </ul>
            </div>
        </div>
        <div id="side_panel">
            <div id="go_place">
                <div class="search-container">
                    <input type="text" class="text_custom" id="searchKeyword" name="searchKeyword" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.">	
                    <button type="button" id="btn_select">ê²€ìƒ‰</button>
                </div>
                <div class="choice_w">
                    <ul>
                        <li class="hashtag"><a href="#"># í¬ë¦¬ìŠ¤ë§ˆìŠ¤ğŸ„</a></li>
                        <li class="hashtag"><a href="#"># ì™€ì¸/ë°”ğŸ¥‚</a></li>
                        <li class="hashtag"><a href="#"># ë¹„ê±´ì‹ë‹¹ğŸ¥—</a></li>
                        <li class="hashtag"><a href="#"># ì—°ë§íŒŒí‹°ğŸ¥³</a></li>
                        <li class="hashtag"><a href="#"># ë¸ŒëŸ°ì¹˜ğŸ¥</a></li>
                        <li class="hashtag"><a href="#"># ì œì² ìŒì‹â˜ƒï¸</a></li>
                        <li class="hashtag"><a href="#"># ë°ì´íŠ¸ğŸ’–</a></li>
                    </ul>
                </div>
            </div>
            <div id="r_list">
                <div class="title"><strong>Search</strong> Results</div>
                <div class="rst_wrap">
                    <div class="rst mCustomScrollbar">
                        <ul id="searchResult" name="searchResult">
                            <li>ê²€ìƒ‰ê²°ê³¼</li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- ìŠ¬ë¼ì´ë“œ ì°½ êµ¬ì¡° -->
            <div id="slide_panel">
                <div id="slide_content"></div>
            </div>
            
        </div>
        <div id="map_wrap" class="map_wrap3" style="height:450px">
            <div id="map_div" class="map_wrap" style='position :relative; bottom:-20px;'></div>
        </div>
        <div class="how_we"></div>
    </div>
    <footer>
        <div class="footerr">
            <div class="ftnavi">
                <ul>
                    <li><a href="">íšŒì‚¬ì†Œê°œ</a></li>
                    <li><a href="">ì˜¤ì‹œëŠ”ê¸¸</a></li>
                    <li><a href="">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a></li>
                    <li><a href="">ì˜ìƒì •ë³´ì²˜ë¦¬ê¸°ê¸°ìš´ì˜ê´€ë¦¬ë°©ì¹¨</a></li>
                    <li><a href="">ì´ìš©ì•½ê´€</a></li>
                    <li><a href="">ì´ë©”ì¼ë¬´ë‹¨ìˆ˜ì§‘ê±°ë¶€</a></li>
                </ul>
            </div>
            <div class="bottom_footer">

                <div class="addr">
                    <p>ì•™ê¼¬<span>|</span>ì„œìš¸ ê¸ˆì²œêµ¬ ê°€ì‚°ë””ì§€í„¸2ë¡œ 101</p>
                    <p class="tel">ëŒ€í‘œë²ˆí˜¸ : 070-777-7777&nbsp;&nbsp;
                        <span>ì˜ˆì•½ë¬¸ì˜ : 7777-7777</span>
                        <span>ë‹¨ì²´ë¬¸ì˜ : 02-7171-1717</span>
                        <span>ë¶„ì–‘ë¬¸ì˜ : 02-737-3737</span>
                        <span>í†µì‹ íŒë§¤ì—…ì‹ ê³  : 2024-ì„œìš¸ê¸ˆì²œ-1213í˜¸</span>
                    </p>
                    <p>ë©”ë¦¬ì¸ í™”ì¬ì™€ ê°œì¸ì •ë³´ ë°°ìƒì±…ì„ë³´í—˜ ê³„ì•½ì„ ì²´ê²°í•˜ì—¬ íšŒì› ê°œì¸ì •ë³´ë¥¼ ë³´í˜¸í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
                    <p class="copy">COPYRIGHT(C) ANGGGO. ALL RIGHTS RESERVED.</p>
                </div>
                <!-- <div class="right"> -->
                <div class="sns">
                    <a href="#"><img src="/static/images/main/insta_btn_fnew.png"></a>
                    <a href="#"><img src="/static/images/main/youtube_btn_fnew.png"></a>
                    <a href="#"><img src="/static/images/main/facebook_btn_fnew.png"></a>
                    <a href="#"><img src="/static/images/main/kakao_ch_btn_fnew.png"></a>
                </div>
            </div>
            <!-- </div> -->
        </div>
    </footer>
    
</body>
</html>